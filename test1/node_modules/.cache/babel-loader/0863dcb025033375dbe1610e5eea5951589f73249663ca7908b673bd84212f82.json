{"ast":null,"code":"import UpdatePassword from '@/components/home/shared/UpdatePassword.vue';\nimport UpdateUserMsg from '@/components/home/shared/UpdateUserMsg.vue';\nimport jwtPrase from '@/assets/js/jwtPrase';\nexport default {\n  name: \"UserMsg\",\n  components: {\n    UpdatePassword,\n    UpdateUserMsg\n  },\n  data() {\n    return {\n      labelList: [],\n      valueList: [],\n      genderList: [],\n      collegeList: [],\n      majorList: [],\n      titleList: [],\n      updatedPassDialogVisible: false,\n      updatedMsgDialogVisible: false\n    };\n  },\n  methods: {\n    showUpdatedPass() {\n      this.updatedPassDialogVisible = true;\n    },\n    showUpdateMsg() {\n      this.updatedMsgDialogVisible = true;\n    },\n    updateDialogClose(val) {\n      this.updatedPassDialogVisible = val;\n    },\n    updateMsgDialogClose(val) {\n      this.updatedMsgDialogVisible = val;\n    },\n    // 初始化页面\n    async initPage() {\n      const studentLabelList = [\"学号\", \"姓名\", \"性别\", \"学院\", \"专业\", \"毕业年份\", \"手机号\", \"邮箱\", \"毕业课题\", \"指导老师\", \"指导老师手机号\", \"指导老师邮箱\", \"指导老师办公室\"];\n      const tutorLabelList = [\"工号\", \"姓名\", \"职称\", \"性别\", \"所属学院\", \"所属系\", \"手机号\", \"邮箱\", \"办公室\"];\n      const adminLabelList = [\"工号\", \"姓名\", \"性别\", \"所属学院\", \"手机号\", \"邮箱\"];\n\n      //根据jwt获取用户类型\n      let payload = jwtPrase();\n      const userType = payload.userType;\n\n      //根据用户类型 选择 labelList\n      if (userType == '0') {\n        //毕业生\n        this.labelList = studentLabelList;\n\n        //根据jwt里的id 获取用户信息\n        await this.getStudentMsg(payload.id);\n      } else if (userType == '1') {\n        //导师\n        this.labelList = tutorLabelList;\n\n        //根据jwt里的id 获取用户信息\n        await this.getTutorMsg(payload.id);\n      } else if (userType == '2') {\n        //管理员\n        this.labelList = adminLabelList;\n\n        //根据jwt里的id  获取用户信息\n        await this.getAdminMsg(payload.id);\n      }\n      this.$forceUpdate();\n    },\n    //根据jwt里的id  获取用户信息(管理员)\n    async getAdminMsg(aId) {\n      const resp = await this.$http.get('/userAdmin/' + aId);\n      if (resp.data.code === 200) {\n        let user = resp.data.data;\n        this.valueList[0] = user.aid;\n        this.valueList[1] = user.aname;\n        this.valueList[2] = user.dictGender.description;\n        this.valueList[3] = user.dictCollege.description;\n        this.valueList[4] = user.phone;\n        this.valueList[5] = user.email;\n      }\n    },\n    //根据jwt里的id  获取用户信息(导师)\n    async getTutorMsg(tId) {\n      const resp = await this.$http.get('/userTutor/' + tId);\n      if (resp.data.code === 200) {\n        let user = resp.data.data;\n        this.valueList[0] = user.tid;\n        this.valueList[1] = user.tutorName;\n        this.valueList[2] = user.dictTutorTitle.description;\n        this.valueList[3] = user.dictGender.description;\n        this.valueList[4] = user.dictCollege.description;\n        this.valueList[5] = user.dictMajor.description + \"系\";\n        this.valueList[6] = user.phone;\n        this.valueList[7] = user.email;\n        this.valueList[8] = user.office;\n      }\n    },\n    //根据jwt里的id  获取用户信息(毕业生)\n    async getStudentMsg(sId) {\n      const _this = this;\n      const resp = await this.$http.get('/userStudent/' + sId);\n      if (resp.data.code === 200) {\n        let user = resp.data.data;\n        this.valueList[0] = user.sid;\n        this.valueList[1] = user.sname;\n        this.valueList[2] = user.dictGender.description;\n        this.valueList[3] = user.dictCollege.description;\n        this.valueList[4] = user.dictMajor.description;\n        this.valueList[5] = user.graduationYear;\n        this.valueList[6] = user.phone;\n        this.valueList[7] = user.email;\n        //根据sid去获取topic\n\n        this.$http.get(\"/topic/selected/\" + user.sid).then(topicResp => {\n          if (topicResp.data.code === 200 && topicResp.data.data !== null) {\n            _this.valueList[8] = topicResp.data.data.topicName;\n            _this.$forceUpdate();\n            let tId = topicResp.data.data.createdBy;\n            _this.$http.get(\"/userTutor/\" + tId).then(resp => {\n              console.log(resp);\n              //根据tId去获取 指导老师信息\n              // this.valueList[9] = tutor.tutorName\n              // this.valueList[10] = tutor.phone\n              // this.valueList[11] = tutor.email\n              // this.valueList[12] = tutor.office\n            });\n          }\n        });\n      }\n    }\n  },\n\n  created() {\n    this.initPage();\n  }\n};","map":{"version":3,"mappings":"AAwBA;AACA;AACA;AAEA;EACAA;EACAC;IACAC;IACAC;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACA;IACA;MACA,gCACA,MACA,MACA,MACA,MACA,QACA,OACA,MACA,QACA,QACA,WACA,UACA,UACA;MACA,8BACA,MACA,MACA,MACA,QACA,OACA,OACA,MACA,MACA;MACA,8BACA,MACA,MACA,QACA,OACA,KACA;;MAEA;MACA;MACA;;MAEA;MACA;QACA;QACA;;QAEA;QACA;MAEA;QACA;QACA;;QAEA;QACA;MAEA;QACA;QACA;;QAEA;QACA;MAEA;MAEA;IAEA;IAEA;IACA;MACA;MACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;MACA;IACA;IACA;IACA;MACA;MACA;QAEA;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;MACA;IACA;IACA;IACA;MACA;MACA;MACA;QAEA;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;UACA;YACAC;YACAA;YAEA;YACAA;cACAC;cACA;cACA;cACA;cACA;cACA;YACA;UAEA;QACA;MASA;IACA;EAEA;;EACAC;IACA;EAEA;AAEA","names":["name","components","UpdatePassword","UpdateUserMsg","data","labelList","valueList","genderList","collegeList","majorList","titleList","updatedPassDialogVisible","updatedMsgDialogVisible","methods","showUpdatedPass","showUpdateMsg","updateDialogClose","updateMsgDialogClose","_this","console","created"],"sourceRoot":"src/components/home/shared","sources":["UserMsg.vue"],"sourcesContent":["<template>\r\n    <div class=\"main\">\r\n        <el-descriptions class=\"margin-top\" title=\"用户信息\" :column=\"2\" border>\r\n            <template slot=\"extra\">\r\n                <el-button plain type=\"warning\" @click=\"showUpdateMsg\">修改信息</el-button>\r\n                <el-button plain type=\"warning\" @click=\"showUpdatedPass\">修改密码</el-button>\r\n            </template>\r\n            <template v-for=\"label, index  in labelList \">\r\n                <el-descriptions-item>\r\n                    <template slot=\"label\">\r\n                        <i class=\"el-icon-s-data\"></i>\r\n                        {{ label }}\r\n                    </template>\r\n                    {{ valueList[index] }}\r\n                </el-descriptions-item>\r\n            </template>\r\n        </el-descriptions>\r\n        <UpdatePassword :visible=\"updatedPassDialogVisible\" @close=\"updateDialogClose\"></UpdatePassword>\r\n        <UpdateUserMsg :visible=\"updatedMsgDialogVisible\" @close=\"updateMsgDialogClose\"></UpdateUserMsg>\r\n\r\n    </div>\r\n</template>\r\n<script>\r\n\r\nimport UpdatePassword from '@/components/home/shared/UpdatePassword.vue';\r\nimport UpdateUserMsg from '@/components/home/shared/UpdateUserMsg.vue';\r\nimport jwtPrase from '@/assets/js/jwtPrase';\r\n\r\nexport default {\r\n    name: \"UserMsg\",\r\n    components: {\r\n        UpdatePassword,\r\n        UpdateUserMsg\r\n    },\r\n    data() {\r\n        return {\r\n            labelList: [],\r\n            valueList: [],\r\n            genderList: [],\r\n            collegeList: [],\r\n            majorList: [],\r\n            titleList: [],\r\n            updatedPassDialogVisible: false,\r\n            updatedMsgDialogVisible: false\r\n        }\r\n    },\r\n    methods: {\r\n        showUpdatedPass() {\r\n            this.updatedPassDialogVisible = true\r\n        },\r\n        showUpdateMsg() {\r\n            this.updatedMsgDialogVisible = true\r\n        },\r\n        updateDialogClose(val) {\r\n            this.updatedPassDialogVisible = val\r\n        },\r\n        updateMsgDialogClose(val) {\r\n            this.updatedMsgDialogVisible = val\r\n        },\r\n        // 初始化页面\r\n        async initPage() {\r\n            const studentLabelList = [\"学号\",\r\n                \"姓名\",\r\n                \"性别\",\r\n                \"学院\",\r\n                \"专业\",\r\n                \"毕业年份\",\r\n                \"手机号\",\r\n                \"邮箱\",\r\n                \"毕业课题\",\r\n                \"指导老师\",\r\n                \"指导老师手机号\",\r\n                \"指导老师邮箱\",\r\n                \"指导老师办公室\"\r\n            ]\r\n            const tutorLabelList = [\"工号\",\r\n                \"姓名\",\r\n                \"职称\",\r\n                \"性别\",\r\n                \"所属学院\",\r\n                \"所属系\",\r\n                \"手机号\",\r\n                \"邮箱\",\r\n                \"办公室\"\r\n            ]\r\n            const adminLabelList = [\"工号\",\r\n                \"姓名\",\r\n                \"性别\",\r\n                \"所属学院\",\r\n                \"手机号\",\r\n                \"邮箱\",\r\n            ]\r\n\r\n            //根据jwt获取用户类型\r\n            let payload = jwtPrase()\r\n            const userType = payload.userType\r\n\r\n            //根据用户类型 选择 labelList\r\n            if (userType == '0') {\r\n                //毕业生\r\n                this.labelList = studentLabelList\r\n\r\n                //根据jwt里的id 获取用户信息\r\n                await this.getStudentMsg(payload.id)\r\n\r\n            } else if (userType == '1') {\r\n                //导师\r\n                this.labelList = tutorLabelList\r\n\r\n                //根据jwt里的id 获取用户信息\r\n                await this.getTutorMsg(payload.id)\r\n\r\n            } else if (userType == '2') {\r\n                //管理员\r\n                this.labelList = adminLabelList\r\n\r\n                //根据jwt里的id  获取用户信息\r\n                await this.getAdminMsg(payload.id)\r\n\r\n            }\r\n\r\n            this.$forceUpdate()\r\n\r\n        },\r\n\r\n        //根据jwt里的id  获取用户信息(管理员)\r\n        async getAdminMsg(aId) {\r\n            const resp = await this.$http.get('/userAdmin/' + aId)\r\n            if (resp.data.code === 200) {\r\n                let user = resp.data.data\r\n                this.valueList[0] = user.aid\r\n                this.valueList[1] = user.aname\r\n                this.valueList[2] = user.dictGender.description\r\n                this.valueList[3] = user.dictCollege.description\r\n                this.valueList[4] = user.phone\r\n                this.valueList[5] = user.email\r\n            }\r\n        },\r\n        //根据jwt里的id  获取用户信息(导师)\r\n        async getTutorMsg(tId) {\r\n            const resp = await this.$http.get('/userTutor/' + tId)\r\n            if (resp.data.code === 200) {\r\n\r\n                let user = resp.data.data\r\n\r\n                this.valueList[0] = user.tid\r\n                this.valueList[1] = user.tutorName\r\n                this.valueList[2] = user.dictTutorTitle.description\r\n                this.valueList[3] = user.dictGender.description\r\n                this.valueList[4] = user.dictCollege.description\r\n                this.valueList[5] = user.dictMajor.description + \"系\"\r\n                this.valueList[6] = user.phone\r\n                this.valueList[7] = user.email\r\n                this.valueList[8] = user.office\r\n            }\r\n        },\r\n        //根据jwt里的id  获取用户信息(毕业生)\r\n        async getStudentMsg(sId) {\r\n            const _this = this\r\n            const resp = await this.$http.get('/userStudent/' + sId)\r\n            if (resp.data.code === 200) {\r\n\r\n                let user = resp.data.data\r\n\r\n                this.valueList[0] = user.sid\r\n                this.valueList[1] = user.sname\r\n                this.valueList[2] = user.dictGender.description\r\n                this.valueList[3] = user.dictCollege.description\r\n                this.valueList[4] = user.dictMajor.description\r\n                this.valueList[5] = user.graduationYear\r\n                this.valueList[6] = user.phone\r\n                this.valueList[7] = user.email\r\n                //根据sid去获取topic\r\n\r\n                this.$http.get(\"/topic/selected/\" + user.sid).then((topicResp) => {\r\n                    if (topicResp.data.code === 200 && topicResp.data.data !== null) {\r\n                        _this.valueList[8] = topicResp.data.data.topicName\r\n                        _this.$forceUpdate()\r\n\r\n                        let tId = topicResp.data.data.createdBy\r\n                        _this.$http.get(\"/userTutor/\" + tId).then((resp) => {\r\n                            console.log(resp);\r\n                            //根据tId去获取 指导老师信息\r\n                            // this.valueList[9] = tutor.tutorName\r\n                            // this.valueList[10] = tutor.phone\r\n                            // this.valueList[11] = tutor.email\r\n                            // this.valueList[12] = tutor.office\r\n                        })\r\n\r\n                    }\r\n                })\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n            }\r\n        },\r\n\r\n    },\r\n    created() {\r\n        this.initPage()\r\n\r\n    },\r\n\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.main {\r\n    line-height: 80px;\r\n    background-color: rgba(255, 255, 255, 0.7);\r\n}\r\n\r\n/deep/.el-descriptions__body .el-descriptions__table {\r\n    height: 720px;\r\n\r\n}\r\n\r\n/deep/.el-descriptions__body {\r\n    background-color: rgba(255, 255, 255, 0.6);\r\n    backdrop-filter: blur(10px);\r\n}\r\n\r\n/deep/.el-descriptions {\r\n    font-size: 18px;\r\n}\r\n\r\n/deep/.el-descriptions__title {\r\n    font-size: 24px;\r\n}\r\n\r\n/deep/.el-descriptions-item__label.is-bordered-label {\r\n    background-color: rgba(255, 255, 255, 0.2);\r\n    backdrop-filter: blur(10px);\r\n    color: black;\r\n}\r\n\r\n/deep/.el-button {\r\n    font-size: 18px;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}