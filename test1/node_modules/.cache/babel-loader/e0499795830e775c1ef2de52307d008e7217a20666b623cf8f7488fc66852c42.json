{"ast":null,"code":"import UpdatePassword from '@/components/home/shared/UpdatePassword.vue';\nimport UpdateUserMsg from '@/components/home/shared/UpdateUserMsg.vue';\nimport jwtPrase from '@/assets/js/jwtPrase';\nexport default {\n  name: \"UserMsg\",\n  components: {\n    UpdatePassword,\n    UpdateUserMsg\n  },\n  data() {\n    return {\n      labelList: [],\n      valueList: [],\n      genderList: [],\n      collegeList: [],\n      majorList: [],\n      titleList: [],\n      updatedPassDialogVisible: false,\n      updatedMsgDialogVisible: false\n    };\n  },\n  methods: {\n    showUpdatedPass() {\n      this.updatedPassDialogVisible = true;\n    },\n    showUpdateMsg() {\n      this.updatedMsgDialogVisible = true;\n    },\n    updateDialogClose(val) {\n      this.updatedPassDialogVisible = val;\n    },\n    updateMsgDialogClose(val) {\n      this.updatedMsgDialogVisible = val;\n    },\n    // 初始化页面\n    initPage() {\n      const studentLabelList = [\"学号\", \"姓名\", \"性别\", \"学院\", \"专业\", \"毕业年份\", \"手机号\", \"邮箱\", \"毕业课题\", \"指导老师\", \"指导老师手机号\", \"指导老师邮箱\", \"指导老师办公室\"];\n      const tutorLabelList = [\"工号\", \"姓名\", \"职称\", \"性别\", \"所属学院\", \"所属系\", \"手机号\", \"邮箱\", \"办公室\"];\n      const adminLabelList = [\"工号\", \"姓名\", \"性别\", \"所属学院\", \"手机号\", \"邮箱\"];\n\n      //根据jwt获取用户类型\n      let payload = jwtPrase();\n      const userType = payload.userType;\n\n      //根据用户类型 选择 labelList\n      if (userType == '0') {\n        //毕业生\n        this.labelList = studentLabelList;\n\n        //根据jwt里的id 获取用户信息\n        this.valueList = [\"300015210227\", \"假名字\", \"假性别\", \"假学院\", \"假专业\", \"假年份\", \"假手机\", \"假邮箱\", \"假课题\", \"假老师\", \"假手机\", \"zzz02902@163.com\", \"这里是假的办公室\"];\n      } else if (userType == '1') {\n        //导师\n        this.labelList = tutorLabelList;\n\n        //根据jwt里的id 获取用户信息\n        this.getTutorMsg(payload.id);\n      } else if (userType == '2') {\n        //管理员\n        this.labelList = adminLabelList;\n\n        //根据jwt里的id  获取用户信息\n        this.getAdminMsg(payload.id);\n      } else {\n        return;\n      }\n    },\n    //根据jwt里的id  获取用户信息(管理员)\n    async getAdminMsg(aId) {\n      const resp = await this.$http.get('/userAdmin/' + aId);\n      if (resp.data.code === 200) {\n        let user = resp.data.data;\n        this.valueList[0] = user.aid;\n        this.valueList[1] = user.aname;\n        this.valueList[2] = user.dictGender.description;\n        this.valueList[3] = user.dictCollege.description;\n        this.valueList[4] = user.phone;\n        this.valueList[5] = user.email;\n        this.$forceUpdate();\n      }\n    },\n    //根据jwt里的id  获取用户信息(导师)\n    async getTutorMsg(tId) {\n      const resp = await this.$http.get('/userTutor/' + tId);\n      if (resp.data.code === 200) {\n        let user = resp.data.data;\n        console.log(user);\n        this.valueList[0] = user.tid;\n        this.valueList[1] = user.tutorName;\n        this.valueList[6] = user.phone;\n        this.valueList[7] = user.email;\n        this.valueList[8] = user.office;\n        const _this = this;\n        this.titleList.forEach(item => {\n          console.log(item.title === user.title);\n          if (item.title === user.title) {\n            _this.valueList[2] = item.description;\n          }\n        });\n        this.genderList.forEach(item => {\n          if (item.gender === user.gender) {\n            _this.valueList[3] = item.description;\n          }\n        });\n        this.collegeList.forEach(item => {\n          if (item.collegeId === user.college) {\n            _this.valueList[4] = item.description;\n          }\n        });\n        this.majorList.forEach(item => {\n          if (item.majorId === user.major) {\n            _this.valueList[5] = item.description;\n          }\n        });\n        this.$forceUpdate();\n      }\n    },\n    //发送请求获取collegeList\n    async getCollegeList() {\n      const resp = await this.$http.get('/dict/college');\n      if (resp.data.code === 200) {\n        this.collegeList = resp.data.data;\n      }\n    },\n    //发送请求获取genderList\n    async getGenderList() {\n      const resp = await this.$http.get('/dict/gender');\n      if (resp.data.code === 200) {\n        this.genderList = resp.data.data;\n      }\n    },\n    //发送请求获取majorList\n    async getMajorList() {\n      const resp = await this.$http.get('/dict/major');\n      if (resp.data.code === 200) {\n        this.majorList = resp.data.data;\n      }\n    },\n    //发送请求获取titleList\n    async getTitleList() {\n      const resp = await this.$http.get('/dict/tutorTitle');\n      if (resp.data.code === 200) {\n        this.titleList = resp.data.data;\n      }\n    }\n  },\n  async created() {\n    this.initPage();\n\n    //发送请求获取genderList\n    await this.getGenderList();\n    //发送请求获取collegeList\n    await this.getCollegeList();\n    //发送请求获取titleList\n    await this.getTitleList();\n    //发送请求获取majorList\n    await this.getMajorList();\n  },\n  watch: {\n    updatedMsgDialogVisible() {\n      this.initPage();\n    }\n  }\n};","map":{"version":3,"mappings":"AAwBA;AACA;AACA;AAEA;EACAA;EACAC;IACAC;IACAC;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA,gCACA,MACA,MACA,MACA,MACA,QACA,OACA,MACA,QACA,QACA,WACA,UACA,UACA;MACA,8BACA,MACA,MACA,MACA,QACA,OACA,OACA,MACA,MACA;MACA,8BACA,MACA,MACA,QACA,OACA,KACA;;MAEA;MACA;MACA;;MAEA;MACA;QACA;QACA;;QAEA;QACA,kBACA,gBACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,oBACA,WACA;MAEA;QACA;QACA;;QAEA;QACA;MAEA;QACA;QACA;;QAEA;QACA;MAGA;QACA;MACA;IAEA;IAEA;IACA;MACA;MACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QAEA;MACA;IACA;IACA;IACA;MACA;MACA;QAEA;QAEAC;QAEA;QACA;QACA;QACA;QACA;QAEA;QAEA;UACAA;UACA;YACAC;UACA;QACA;QACA;UACA;YACAA;UAEA;QACA;QACA;UACA;YACAA;UAEA;QACA;QACA;UACA;YACAA;UAEA;QACA;QAEA;MACA;IACA;IAEA;IACA;MACA;MACA;QACA;MACA;IACA;IACA;IACA;MACA;MACA;QACA;MACA;IACA;IACA;IACA;MACA;MACA;QACA;MACA;IACA;IACA;IACA;MACA;MACA;QACA;MACA;IACA;EACA;EACA;IACA;;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;EACA;EACAC;IACAT;MACA;IACA;EACA;AAEA","names":["name","components","UpdatePassword","UpdateUserMsg","data","labelList","valueList","genderList","collegeList","majorList","titleList","updatedPassDialogVisible","updatedMsgDialogVisible","methods","showUpdatedPass","showUpdateMsg","updateDialogClose","updateMsgDialogClose","initPage","console","_this","watch"],"sourceRoot":"src/components/home/shared","sources":["UserMsg.vue"],"sourcesContent":["<template>\r\n    <div class=\"main\">\r\n        <el-descriptions class=\"margin-top\" title=\"用户信息\" :column=\"2\" border>\r\n            <template slot=\"extra\">\r\n                <el-button plain type=\"warning\" @click=\"showUpdateMsg\">修改信息</el-button>\r\n                <el-button plain type=\"warning\" @click=\"showUpdatedPass\">修改密码</el-button>\r\n            </template>\r\n            <template v-for=\"label, index  in labelList \">\r\n                <el-descriptions-item>\r\n                    <template slot=\"label\">\r\n                        <i class=\"el-icon-s-data\"></i>\r\n                        {{ label }}\r\n                    </template>\r\n                    {{ valueList[index] }}\r\n                </el-descriptions-item>\r\n            </template>\r\n        </el-descriptions>\r\n        <UpdatePassword :visible=\"updatedPassDialogVisible\" @close=\"updateDialogClose\"></UpdatePassword>\r\n        <UpdateUserMsg :visible=\"updatedMsgDialogVisible\" @close=\"updateMsgDialogClose\"></UpdateUserMsg>\r\n\r\n    </div>\r\n</template>\r\n<script>\r\n\r\nimport UpdatePassword from '@/components/home/shared/UpdatePassword.vue';\r\nimport UpdateUserMsg from '@/components/home/shared/UpdateUserMsg.vue';\r\nimport jwtPrase from '@/assets/js/jwtPrase';\r\n\r\nexport default {\r\n    name: \"UserMsg\",\r\n    components: {\r\n        UpdatePassword,\r\n        UpdateUserMsg\r\n    },\r\n    data() {\r\n        return {\r\n            labelList: [],\r\n            valueList: [],\r\n            genderList: [],\r\n            collegeList: [],\r\n            majorList: [],\r\n            titleList: [],\r\n            updatedPassDialogVisible: false,\r\n            updatedMsgDialogVisible: false\r\n        }\r\n    },\r\n    methods: {\r\n        showUpdatedPass() {\r\n            this.updatedPassDialogVisible = true\r\n        },\r\n        showUpdateMsg() {\r\n            this.updatedMsgDialogVisible = true\r\n        },\r\n        updateDialogClose(val) {\r\n            this.updatedPassDialogVisible = val\r\n        },\r\n        updateMsgDialogClose(val) {\r\n            this.updatedMsgDialogVisible = val\r\n        },\r\n        // 初始化页面\r\n        initPage() {\r\n            const studentLabelList = [\"学号\",\r\n                \"姓名\",\r\n                \"性别\",\r\n                \"学院\",\r\n                \"专业\",\r\n                \"毕业年份\",\r\n                \"手机号\",\r\n                \"邮箱\",\r\n                \"毕业课题\",\r\n                \"指导老师\",\r\n                \"指导老师手机号\",\r\n                \"指导老师邮箱\",\r\n                \"指导老师办公室\"\r\n            ]\r\n            const tutorLabelList = [\"工号\",\r\n                \"姓名\",\r\n                \"职称\",\r\n                \"性别\",\r\n                \"所属学院\",\r\n                \"所属系\",\r\n                \"手机号\",\r\n                \"邮箱\",\r\n                \"办公室\"\r\n            ]\r\n            const adminLabelList = [\"工号\",\r\n                \"姓名\",\r\n                \"性别\",\r\n                \"所属学院\",\r\n                \"手机号\",\r\n                \"邮箱\",\r\n            ]\r\n\r\n            //根据jwt获取用户类型\r\n            let payload = jwtPrase()\r\n            const userType = payload.userType\r\n\r\n            //根据用户类型 选择 labelList\r\n            if (userType == '0') {\r\n                //毕业生\r\n                this.labelList = studentLabelList\r\n\r\n                //根据jwt里的id 获取用户信息\r\n                this.valueList = [\r\n                    \"300015210227\",\r\n                    \"假名字\",\r\n                    \"假性别\",\r\n                    \"假学院\",\r\n                    \"假专业\",\r\n                    \"假年份\",\r\n                    \"假手机\",\r\n                    \"假邮箱\",\r\n                    \"假课题\",\r\n                    \"假老师\",\r\n                    \"假手机\",\r\n                    \"zzz02902@163.com\",\r\n                    \"这里是假的办公室\"\r\n                ]\r\n\r\n            } else if (userType == '1') {\r\n                //导师\r\n                this.labelList = tutorLabelList\r\n\r\n                //根据jwt里的id 获取用户信息\r\n                this.getTutorMsg(payload.id)\r\n\r\n            } else if (userType == '2') {\r\n                //管理员\r\n                this.labelList = adminLabelList\r\n\r\n                //根据jwt里的id  获取用户信息\r\n                this.getAdminMsg(payload.id)\r\n\r\n\r\n            } else {\r\n                return;\r\n            }\r\n\r\n        },\r\n\r\n        //根据jwt里的id  获取用户信息(管理员)\r\n        async getAdminMsg(aId) {\r\n            const resp = await this.$http.get('/userAdmin/' + aId)\r\n            if (resp.data.code === 200) {\r\n                let user = resp.data.data\r\n                this.valueList[0] = user.aid\r\n                this.valueList[1] = user.aname\r\n                this.valueList[2] = user.dictGender.description\r\n                this.valueList[3] = user.dictCollege.description\r\n                this.valueList[4] = user.phone\r\n                this.valueList[5] = user.email\r\n\r\n                this.$forceUpdate()\r\n            }\r\n        },\r\n        //根据jwt里的id  获取用户信息(导师)\r\n        async getTutorMsg(tId) {\r\n            const resp = await this.$http.get('/userTutor/' + tId)\r\n            if (resp.data.code === 200) {\r\n\r\n                let user = resp.data.data\r\n\r\n                console.log(user);\r\n\r\n                this.valueList[0] = user.tid\r\n                this.valueList[1] = user.tutorName\r\n                this.valueList[6] = user.phone\r\n                this.valueList[7] = user.email\r\n                this.valueList[8] = user.office\r\n\r\n                const _this = this\r\n\r\n                this.titleList.forEach((item) => {\r\n                    console.log(item.title === user.title);\r\n                    if (item.title === user.title){\r\n                        _this.valueList[2] = item.description\r\n                    }\r\n                })\r\n                this.genderList.forEach((item) => {\r\n                    if (item.gender === user.gender){\r\n                        _this.valueList[3] = item.description\r\n\r\n                    }\r\n                })\r\n                this.collegeList.forEach((item) => {\r\n                    if (item.collegeId === user.college){\r\n                        _this.valueList[4] = item.description\r\n\r\n                    }\r\n                })\r\n                this.majorList.forEach((item) => {\r\n                    if (item.majorId === user.major){\r\n                        _this.valueList[5] = item.description\r\n\r\n                    }\r\n                })\r\n\r\n                this.$forceUpdate()\r\n            }\r\n        },\r\n\r\n        //发送请求获取collegeList\r\n        async getCollegeList() {\r\n            const resp = await this.$http.get('/dict/college')\r\n            if (resp.data.code === 200) {\r\n                this.collegeList = resp.data.data\r\n            }\r\n        },\r\n        //发送请求获取genderList\r\n        async getGenderList() {\r\n            const resp = await this.$http.get('/dict/gender')\r\n            if (resp.data.code === 200) {\r\n                this.genderList = resp.data.data\r\n            }\r\n        },\r\n        //发送请求获取majorList\r\n        async getMajorList() {\r\n            const resp = await this.$http.get('/dict/major')\r\n            if (resp.data.code === 200) {\r\n                this.majorList = resp.data.data\r\n            }\r\n        },\r\n        //发送请求获取titleList\r\n        async getTitleList() {\r\n            const resp = await this.$http.get('/dict/tutorTitle')\r\n            if (resp.data.code === 200) {\r\n                this.titleList = resp.data.data\r\n            }\r\n        },\r\n    },\r\n    async created() {\r\n        this.initPage()\r\n\r\n        //发送请求获取genderList\r\n        await this.getGenderList()\r\n        //发送请求获取collegeList\r\n        await this.getCollegeList()\r\n        //发送请求获取titleList\r\n        await this.getTitleList()\r\n        //发送请求获取majorList\r\n        await this.getMajorList()\r\n    },\r\n    watch: {\r\n        updatedMsgDialogVisible() {\r\n            this.initPage()\r\n        }\r\n    }\r\n\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.main {\r\n    line-height: 80px;\r\n    background-color: rgba(255, 255, 255, 0.7);\r\n}\r\n\r\n/deep/.el-descriptions__body .el-descriptions__table {\r\n    height: 720px;\r\n\r\n}\r\n\r\n/deep/.el-descriptions__body {\r\n    background-color: rgba(255, 255, 255, 0.6);\r\n    backdrop-filter: blur(10px);\r\n}\r\n\r\n/deep/.el-descriptions {\r\n    font-size: 18px;\r\n}\r\n\r\n/deep/.el-descriptions__title {\r\n    font-size: 24px;\r\n}\r\n\r\n/deep/.el-descriptions-item__label.is-bordered-label {\r\n    background-color: rgba(255, 255, 255, 0.2);\r\n    backdrop-filter: blur(10px);\r\n    color: black;\r\n}\r\n\r\n/deep/.el-button {\r\n    font-size: 18px;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}