{"ast":null,"code":"import jwtPrase from '@/assets/js/jwtPrase';\nexport default {\n  name: \"DialogStuInfo\",\n  props: [\"formType\", \"sId\", 'dialogVisible'],\n  emits: ['closeDialog'],\n  data() {\n    return {\n      visible: false,\n      title: '',\n      infoDetail: {\n        sid: '',\n        sname: \"\",\n        gender: \"\",\n        password: \"\",\n        graduationYear: \"\",\n        college: \"\",\n        major: \"\",\n        phone: \"\",\n        email: \"\",\n        topicName: ''\n      },\n      genderList: '',\n      collegeList: '',\n      majorList: '',\n      rules: {\n        sid: [{\n          required: true,\n          message: '学号不能为空',\n          trigger: 'blur'\n        }],\n        sname: [{\n          required: true,\n          message: '学生姓名不能为空',\n          trigger: 'blur'\n        }],\n        gender: [{\n          required: true,\n          message: '请选择学生性别',\n          trigger: 'change'\n        }],\n        password: [{\n          required: true,\n          message: '密码不能为空',\n          trigger: 'blur'\n        }],\n        graduationYear: [{\n          required: true,\n          message: '毕业年份不能为空',\n          trigger: 'blur'\n        }],\n        college: [{\n          required: true,\n          message: '请选择学院',\n          trigger: 'change'\n        }],\n        major: [{\n          required: true,\n          message: '请选择专业名称',\n          trigger: 'change'\n        }],\n        phone: [{\n          required: true,\n          message: '请输入手机号',\n          trigger: 'blur'\n        }, {\n          mix: 11,\n          max: 11,\n          message: '手机号长度为11位',\n          trigger: 'change'\n        }],\n        email: [{\n          required: true,\n          message: '请输入邮箱账号',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  methods: {\n    submitForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          // 发送请求\n          if (this.formType == '0') {\n            //新增\n            this.$confirm('此操作将新增毕业生信息, 是否继续?', '温馨提示', {\n              confirmButtonText: '确定',\n              cancelButtonText: '取消',\n              type: \"success\"\n            }).then(() => {\n              // 发送新增请求\n              this.addUser();\n            }).catch(() => {\n              this.$message({\n                type: 'info',\n                message: '已取消新增'\n              });\n            });\n          } else if (this.formType == '1') {\n            //修改\n            this.$confirm('此操作将修改毕业生信息, 是否继续?', '温馨提示', {\n              confirmButtonText: '确定',\n              cancelButtonText: '取消',\n              type: \"success\"\n            }).then(() => {\n              // 发送修改请求\n              this.updataUser();\n            }).catch(() => {\n              this.$message({\n                type: 'info',\n                message: '已取消修改'\n              });\n            });\n          }\n        } else {\n          return false;\n        }\n      });\n    },\n    // 关闭dialog\n    closeDialogEmit() {\n      this.visible = false;\n      this.$emit('closeDialog', this.visible);\n    },\n    //发送请求获取collegeList\n    async getCollegeList() {\n      const resp = await this.$http.get('/dict/college');\n      if (resp.data.code === 200) {\n        this.collegeList = resp.data.data;\n      }\n    },\n    //发送请求获取genderList\n    async getGenderList() {\n      const resp = await this.$http.get('/dict/gender');\n      if (resp.data.code === 200) {\n        this.genderList = resp.data.data;\n      }\n    },\n    //发送请求获取majorList\n    async getMajorList(id) {\n      const resp = await this.$http.get('/dict/major/college/' + id);\n      if (resp.data.code === 200) {\n        this.majorList = resp.data.data;\n      }\n    },\n    //新增毕业生信息\n    async addUser() {\n      //设置更新者的id\n      this.infoDetail.updatedBy = jwtPrase().id;\n      const resp = await this.$http({\n        url: '/userStudent',\n        method: \"post\",\n        data: this.infoDetail\n      });\n      if (resp.data.code === 200) {\n        if (resp.data.data == true) {\n          this.$message.success(resp.data.msg);\n        } else {\n          this.$message.error(resp.data.msg);\n        }\n      }\n    },\n    //修改毕业生信息\n    async updataUser() {\n      //设置更新者的id\n      this.infoDetail.updatedBy = jwtPrase().id;\n      const resp = await this.$http({\n        url: '/userStudent',\n        method: \"put\",\n        data: this.infoDetail\n      });\n      if (resp.data.code === 200) {\n        if (resp.data.data == true) {\n          this.$message.success(resp.data.msg);\n        } else {\n          this.$message.error(resp.data.msg);\n        }\n      }\n    },\n    //根据sId获取毕业生信息\n    async getStudentInfo() {\n      const resp = await this.$http.get(\"/userStudent/\" + this.sId);\n      if (resp.data.code === 200 && resp.data.data !== null) {\n        this.infoDetail = resp.data.data;\n      }\n    }\n  },\n  watch: {\n    dialogVisible(newval) {\n      this.visible = newval;\n    },\n    'infoDetail.college'(newval) {\n      //根据newval发送请求获取majorList\n      this.getMajorList(newval);\n    },\n    sId(val) {\n      if (val === '') {\n        //重置表单\n        this.infoDetail = {\n          sid: '',\n          sname: \"\",\n          gender: \"\",\n          password: \"\",\n          graduationYear: \"\",\n          college: \"\",\n          major: \"\",\n          phone: \"\",\n          email: \"\",\n          topicName: ''\n        };\n      }\n      //发送请求获取毕业生信息\n      this.getStudentInfo();\n    }\n  },\n  updated() {\n    if (this.formType === '1') {\n      this.title = '修改学生信息';\n    } else {\n      this.title = '新增学生信息';\n    }\n  },\n  created() {\n    //发送请求获取genderList\n    this.getGenderList();\n    //发送请求获取collegeList\n    this.getCollegeList();\n  }\n};","map":{"version":3,"mappings":"AAuEA;AACA;EACAA;EACAC;EACAC;EACAC;IACA;MACAC;MACAC;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;MAEAC;QACAb,MACA;UAAAc;UAAAC;UAAAC;QAAA,EACA;QACAf,QACA;UAAAa;UAAAC;UAAAC;QAAA,EACA;QACAd,SACA;UAAAY;UAAAC;UAAAC;QAAA,EACA;QACAb,WACA;UAAAW;UAAAC;UAAAC;QAAA,EACA;QACAZ,iBACA;UAAAU;UAAAC;UAAAC;QAAA,EACA;QACAX,UACA;UAAAS;UAAAC;UAAAC;QAAA,EACA;QACAV,QACA;UAAAQ;UAAAC;UAAAC;QAAA,EACA;QACAT,QACA;UAAAO;UAAAC;UAAAC;QAAA,GACA;UAAAC;UAAAC;UAAAH;UAAAC;QAAA,EACA;QACAR,QACA;UAAAM;UAAAC;UAAAC;QAAA;MAGA;IACA;EACA;EACAG;IACAC;MACA;QACA;UACA;UACA;YACA;YACA;cACAC;cACAC;cACAC;YACA;cACA;cACA;YACA;cACA;gBACAA;gBACAR;cACA;YACA;UACA;YACA;YACA;cACAM;cACAC;cACAC;YACA;cACA;cACA;YACA;cACA;gBACAA;gBACAR;cACA;YACA;UAEA;QACA;UACA;QACA;MACA;IACA;IACA;IACAS;MACA;MACA;IACA;IACA;IACA;MACA;MACA;QACA;MACA;IACA;IACA;IACA;MACA;MACA;QACA;MACA;IACA;IACA;IACA;MACA;MACA;QACA;MACA;IACA;IACA;IACA;MACA;MACA;MAEA;QACAC;QACAC;QACA9B;MACA;MACA;QACA;UACA;QAEA;UACA;QACA;MACA;IACA;IACA;IACA;MACA;MACA;MAEA;QACA6B;QACAC;QACA9B;MACA;MACA;QACA;UACA;QACA;UACA;QACA;MACA;IACA;IACA;IACA;MACA;MACA;QACA;MACA;IACA;EACA;EACA+B;IACAC;MACA;IACA;IACA;MACA;MACA;IACA;IACAC;MACA;QACA;QACA;UACA7B;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;QACA;MACA;MACA;MACA;IACA;EACA;EACAqB;IAEA;MACA;IACA;MACA;IACA;EAEA;EACAC;IACA;IACA;IACA;IACA;EAEA;AAEA","names":["name","props","emits","data","visible","title","infoDetail","sid","sname","gender","password","graduationYear","college","major","phone","email","topicName","genderList","collegeList","majorList","rules","required","message","trigger","mix","max","methods","submitForm","confirmButtonText","cancelButtonText","type","closeDialogEmit","url","method","watch","dialogVisible","sId","updated","created"],"sourceRoot":"src/components/home/admin","sources":["DialogStuInfo.vue"],"sourcesContent":["<template>\r\n    <el-dialog :title=\"title\" :visible.sync=\"visible\" width=\"800px\" @close=\"closeDialogEmit\">\r\n\r\n        <el-form ref=\"infoForm\" :rules=\"rules\" :model=\"infoDetail\" label-width=\"100px\" class=\"box-form\">\r\n            <el-form-item label=\"学号\" prop=\"sid\">\r\n                <el-input v-model.trim=\"infoDetail.sid\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"学生姓名\" prop=\"sname\">\r\n                <el-input v-model.trim=\"infoDetail.sname\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"性别\" prop=\"gender\">\r\n                <el-select v-model.trim=\"infoDetail.gender\" placeholder=\"请选择性别\">\r\n                    <el-option v-for=\"item in genderList\" :key=\"item.gender\" :label=\"item.description\"\r\n                        :value=\"item.gender\">\r\n                    </el-option>\r\n                </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"密码\" prop=\"password\">\r\n                <el-input v-model.trim=\"infoDetail.password\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"毕业年份\" prop=\"graduationYear\">\r\n                <el-input v-model.trim=\"infoDetail.graduationYear\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"学院\" prop=\"college\">\r\n                <el-select v-model.trim=\"infoDetail.college\" placeholder=\"请选择学院\">\r\n                    <el-option v-for=\"item in collegeList\" :key=\"item.college\" :label=\"item.description\"\r\n                        :value=\"item.college\">\r\n                    </el-option>\r\n                </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"专业\" prop=\"major\">\r\n                <el-select v-model.trim=\"infoDetail.major\" placeholder=\"请选择专业\">\r\n                    <el-option v-for=\"item in majorList\" :key=\"item.major\" :label=\"item.description\"\r\n                        :value=\"item.major\">\r\n                    </el-option>\r\n                </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"手机号\" prop=\"phone\">\r\n                <el-input v-model.trim=\"infoDetail.phone\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"邮箱\" prop=\"email\">\r\n                <el-input v-model.trim=\"infoDetail.email\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"课题名称\" v-if=\"formType === '1'\">\r\n                <el-input disabled v-model.trim=\"infoDetail.topicName\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"课题名称\" v-else>\r\n                <el-input v-model.trim=\"infoDetail.topicName\"></el-input>\r\n            </el-form-item>\r\n\r\n            <el-form-item>\r\n                <el-row>\r\n                    <el-button plain type=\"primary\" class=\"info_btns\" v-if=\"formType === '0'\"\r\n                        @click=\"submitForm('infoForm')\">新增学生信息\r\n                    </el-button>\r\n\r\n                    <el-button plain type=\"primary\" class=\"info_btns\" v-else @click=\"submitForm('infoForm')\">修改学生信息\r\n                    </el-button>\r\n\r\n                    <el-button plain type=\"danger\" class=\"info_btns\" @click=\"closeDialogEmit\">取消</el-button>\r\n\r\n                </el-row>\r\n\r\n\r\n            </el-form-item>\r\n        </el-form>\r\n    </el-dialog>\r\n\r\n</template>\r\n\r\n<script>\r\nimport jwtPrase from '@/assets/js/jwtPrase';\r\nexport default {\r\n    name: \"DialogStuInfo\",\r\n    props: [\"formType\", \"sId\", 'dialogVisible'],\r\n    emits: ['closeDialog'],\r\n    data() {\r\n        return {\r\n            visible: false,\r\n            title: '',\r\n            infoDetail: {\r\n                sid: '',\r\n                sname: \"\",\r\n                gender: \"\",\r\n                password: \"\",\r\n                graduationYear: \"\",\r\n                college: \"\",\r\n                major: \"\",\r\n                phone: \"\",\r\n                email: \"\",\r\n                topicName: ''\r\n            },\r\n            genderList: '',\r\n            collegeList: '',\r\n            majorList: '',\r\n\r\n            rules: {\r\n                sid: [\r\n                    { required: true, message: '学号不能为空', trigger: 'blur' },\r\n                ],\r\n                sname: [\r\n                    { required: true, message: '学生姓名不能为空', trigger: 'blur' },\r\n                ],\r\n                gender: [\r\n                    { required: true, message: '请选择学生性别', trigger: 'change' },\r\n                ],\r\n                password: [\r\n                    { required: true, message: '密码不能为空', trigger: 'blur' },\r\n                ],\r\n                graduationYear: [\r\n                    { required: true, message: '毕业年份不能为空', trigger: 'blur' },\r\n                ],\r\n                college: [\r\n                    { required: true, message: '请选择学院', trigger: 'change' },\r\n                ],\r\n                major: [\r\n                    { required: true, message: '请选择专业名称', trigger: 'change' },\r\n                ],\r\n                phone: [\r\n                    { required: true, message: '请输入手机号', trigger: 'blur' },\r\n                    { mix: 11, max: 11, message: '手机号长度为11位', trigger: 'change' }\r\n                ],\r\n                email: [\r\n                    { required: true, message: '请输入邮箱账号', trigger: 'blur' },\r\n                ],\r\n\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n        submitForm(formName) {\r\n            this.$refs[formName].validate((valid) => {\r\n                if (valid) {\r\n                    // 发送请求\r\n                    if (this.formType == '0') {\r\n                        //新增\r\n                        this.$confirm('此操作将新增毕业生信息, 是否继续?', '温馨提示', {\r\n                            confirmButtonText: '确定',\r\n                            cancelButtonText: '取消',\r\n                            type: \"success\"\r\n                        }).then(() => {\r\n                            // 发送新增请求\r\n                            this.addUser()\r\n                        }).catch(() => {\r\n                            this.$message({\r\n                                type: 'info',\r\n                                message: '已取消新增'\r\n                            });\r\n                        })\r\n                    } else if (this.formType == '1') {\r\n                        //修改\r\n                        this.$confirm('此操作将修改毕业生信息, 是否继续?', '温馨提示', {\r\n                            confirmButtonText: '确定',\r\n                            cancelButtonText: '取消',\r\n                            type: \"success\"\r\n                        }).then(() => {\r\n                            // 发送修改请求\r\n                            this.updataUser()\r\n                        }).catch(() => {\r\n                            this.$message({\r\n                                type: 'info',\r\n                                message: '已取消修改'\r\n                            });\r\n                        })\r\n\r\n                    }\r\n                } else {\r\n                    return false;\r\n                }\r\n            });\r\n        },\r\n        // 关闭dialog\r\n        closeDialogEmit() {\r\n            this.visible = false\r\n            this.$emit('closeDialog', this.visible)\r\n        },\r\n        //发送请求获取collegeList\r\n        async getCollegeList() {\r\n            const resp = await this.$http.get('/dict/college')\r\n            if (resp.data.code === 200) {\r\n                this.collegeList = resp.data.data\r\n            }\r\n        },\r\n        //发送请求获取genderList\r\n        async getGenderList() {\r\n            const resp = await this.$http.get('/dict/gender')\r\n            if (resp.data.code === 200) {\r\n                this.genderList = resp.data.data\r\n            }\r\n        },\r\n        //发送请求获取majorList\r\n        async getMajorList(id) {\r\n            const resp = await this.$http.get('/dict/major/college/' + id)\r\n            if (resp.data.code === 200) {\r\n                this.majorList = resp.data.data\r\n            }\r\n        },\r\n        //新增毕业生信息\r\n        async addUser() {\r\n            //设置更新者的id\r\n            this.infoDetail.updatedBy = jwtPrase().id\r\n\r\n            const resp = await this.$http({\r\n                url: '/userStudent',\r\n                method: \"post\",\r\n                data: this.infoDetail\r\n            })\r\n            if (resp.data.code === 200) {\r\n                if (resp.data.data == true) {\r\n                    this.$message.success(resp.data.msg)\r\n\r\n                } else {\r\n                    this.$message.error(resp.data.msg)\r\n                }\r\n            }\r\n        },\r\n        //修改毕业生信息\r\n        async updataUser() {\r\n            //设置更新者的id\r\n            this.infoDetail.updatedBy = jwtPrase().id\r\n\r\n            const resp = await this.$http({\r\n                url: '/userStudent',\r\n                method: \"put\",\r\n                data: this.infoDetail\r\n            })\r\n            if (resp.data.code === 200) {\r\n                if (resp.data.data == true) {\r\n                    this.$message.success(resp.data.msg)\r\n                } else {\r\n                    this.$message.error(resp.data.msg)\r\n                }\r\n            }\r\n        },\r\n        //根据sId获取毕业生信息\r\n        async getStudentInfo() {\r\n            const resp = await this.$http.get(\"/userStudent/\" + this.sId)\r\n            if (resp.data.code === 200 && resp.data.data !== null) {\r\n                this.infoDetail = resp.data.data\r\n            }\r\n        }\r\n    },\r\n    watch: {\r\n        dialogVisible(newval) {\r\n            this.visible = newval\r\n        },\r\n        'infoDetail.college'(newval) {\r\n            //根据newval发送请求获取majorList\r\n            this.getMajorList(newval)\r\n        },\r\n        sId(val) {\r\n            if (val === '') {\r\n                //重置表单\r\n                this.infoDetail = {\r\n                    sid: '',\r\n                    sname: \"\",\r\n                    gender: \"\",\r\n                    password: \"\",\r\n                    graduationYear: \"\",\r\n                    college: \"\",\r\n                    major: \"\",\r\n                    phone: \"\",\r\n                    email: \"\",\r\n                    topicName: ''\r\n                }\r\n            }\r\n            //发送请求获取毕业生信息\r\n            this.getStudentInfo()\r\n        }\r\n    },\r\n    updated() {\r\n\r\n        if (this.formType === '1') {\r\n            this.title = '修改学生信息'\r\n        } else {\r\n            this.title = '新增学生信息'\r\n        }\r\n\r\n    },\r\n    created() {\r\n        //发送请求获取genderList\r\n        this.getGenderList()\r\n        //发送请求获取collegeList\r\n        this.getCollegeList()\r\n\r\n    }\r\n\r\n}\r\n</script>\r\n<style scoped lang=\"less\">\r\n.info_btns {\r\n    margin-top: 30px;\r\n    margin-left: 110px;\r\n    width: 150px;\r\n    font-size: 18px;\r\n}\r\n\r\n.box-form {\r\n    line-height: 23px;\r\n    font-size: 22px;\r\n    text-align: left;\r\n    height: 720px;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}